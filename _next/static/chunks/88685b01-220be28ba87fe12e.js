"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[481],{63465:(e,t,i)=>{i.d(t,{Kx:()=>eZ,r8:()=>ta,sA:()=>tr});var n=i(28499),r=i.n(n),o=i(33196),s=i.n(o),a=i(23636),c=i.n(a),u=i(20209),l=i.n(u),h=i(52634),d=i.n(h),f=i(50016),y=i(98609),m=i.n(y),p=i(41436),v=i.n(p),g=i(35890),k=i.n(g),_=i(73875),b=i.n(_),F=i(84082),A=i.n(F),N=i(51829),w=i.n(N),I=i(44108),R=i.n(I),M=i(20422),C=i.n(M),O=i(59953),P=i.n(O),z=i(50920),j=i.n(z),S=i(6928),T=i.n(S),E=i(53348),K=i.n(E),q=i(87993),x=i.n(q),D=i(9649),Y=i.n(D),H=i(84631),B=i.n(H),W=i(62606),L=i.n(W);i(42983);var G=i(27732);function J(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function Q(e){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function U(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function $(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Z(e,t,i){return t&&$(e.prototype,t),i&&$(e,i),e}function V(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function X(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&et(e,t)}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function et(e,t){return(et=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ei(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function en(e,t,i){return(en=ei()?Reflect.construct:function(e,t,i){var n=[null];n.push.apply(n,t);var r=new(Function.bind.apply(e,n));return i&&et(r,i.prototype),r}).apply(null,arguments)}function er(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eo(e){var t=ei();return function(){var i,n=ee(e);return i=t?Reflect.construct(n,arguments,ee(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return er(e)}(this,i)}}function es(e,t){return ec(e)||function(e,t){var i,n,r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var o=[],s=!0,a=!1;try{for(r=r.call(e);!(s=(i=r.next()).done)&&(o.push(i.value),!t||o.length!==t);s=!0);}catch(e){a=!0,n=e}finally{try{s||null==r.return||r.return()}finally{if(a)throw n}}return o}}(e,t)||el(e,t)||ed()}function ea(e){return function(e){if(Array.isArray(e))return eh(e)}(e)||eu(e)||el(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ec(e){if(Array.isArray(e))return e}function eu(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function el(e,t){if(e){if("string"==typeof e)return eh(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if("Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return eh(e,t)}}function eh(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=Array(t);i<t;i++)n[i]=e[i];return n}function ed(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}i(53742);var ef=function e(){this.build=function(t){var i,n,o,a=this,u={},h=Object.assign({},this.attrs);return delete h.afterCreate,Object.keys(h).forEach(function(t){e.isTrait.call(a,t)&&delete h[t]}),(n=new function(){},o=[],Object.keys(h).forEach(function(e){var t;Object.defineProperty(n.constructor.prototype,e,{get:function(){return o.push([i,e]),t},set:function(e){t=e},enumerable:!1,configurable:!0})}),Object.keys(h).forEach(function(e){var t=h[e];"function"!=typeof t&&(n[e]=t)}),Object.keys(h).forEach(function(e){var r=h[e];i=e,"function"==typeof r&&(n[e]=r.call(n,t)),o.push([e])}),function(e){for(var t=l()(d()(e)),i=t.length,n=Array(i),r={},o=i,s=function o(s,a,c){if(c.indexOf(s)>=0)throw Error("Cyclic dependency in properties ".concat(JSON.stringify(c)));if(!r[a]){r[a]=!0;var u=e.filter(function(e){return e&&e[0]===s});if(a=u.length){var l=c.concat(s);do{var h=u[--a][1];h&&o(h,t.indexOf(h),l)}while(a)}n[--i]=s}};o--;)r[o]||s(t[o],o,[]);return n.reverse()}(o)).forEach(function(e){i=function(e){return c()(e,n)},n=function(e){return Array.isArray(e)?e.map(n):r()(e)?i(e):s()(e)?e.call(h,t):e};var i,n,o=h[e];s()(o)?u[e]=o.call(u,t):u[e]=n(o)}),u}};ef.extend=function(e){var t=Object.assign({},this.attrs,e),i=function(){this.attrs=t,ef.call(this)};return i.extend=ef.extend,i.extractAfterCreateCallbacks=ef.extractAfterCreateCallbacks,i.isTrait=ef.isTrait,i.attrs=t,i},ef.extractAfterCreateCallbacks=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.traits,n=[],r=this.attrs||{};return r.afterCreate&&n.push(r.afterCreate),(Array.isArray(i)?i:Object.keys(r)).filter(function(t){return e.isTrait(t)&&r[t].extension.afterCreate}).forEach(function(e){n.push(r[e].extension.afterCreate)}),n},ef.isTrait=function(e){var t=this.attrs;return r()(t[e])&&!0===t[e].__isTrait__};var ey=function(){function e(){U(this,e),this._nextId=1,this._ids={}}return Z(e,[{key:"get",value:function(){return this._nextId}},{key:"set",value:function(e){if(this._ids[e])throw Error("Attempting to use the ID ".concat(e,", but it's already been used"));(+e).toString()===e.toString()&&+e>=this._nextId&&(this._nextId=+e+1),this._ids[e]=!0}},{key:"inc",value:function(){var e=this.get()+1;return this._nextId=e,e}},{key:"fetch",value:function(){var e=this.get();return this._ids[e]=!0,this.inc(),e.toString()}},{key:"reset",value:function(){this._nextId=1,this._ids={}}}]),e}(),em=console.warn,ep=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;U(this,e),this.code=t,this.headers=i,204===t?void 0!==n&&""!==n?em("Mirage: One of your route handlers is returning a custom\n          204 Response that has data, but this is a violation of the HTTP spec\n          and could lead to unexpected behavior. 204 responses should have no\n          content (an empty string) as their body."):this.data="":void 0!==n&&""!==n||Object.prototype.hasOwnProperty.call(this.headers,"Content-Type")?this.data=n:this.data={},204===t||Object.prototype.hasOwnProperty.call(this.headers,"Content-Type")||(this.headers["Content-Type"]="application/json")}return Z(e,[{key:"toRackResponse",value:function(){return[this.code,this.headers,this.data]}}]),e}(),ev={},eg={},ek={},e_={};function eb(e){if("string"!=typeof ev[e]){var t=(0,f.PT)(eA(e),!1).split("/").map(m()).join("/");ev[e]=t}return ev[e]}function eF(e){if("string"!=typeof eg[e]){var t=(0,f._k)(eA(e));eg[e]=t}return eg[e]}function eA(e){if("string"!=typeof ek[e]){var t=(0,f.z9)(e);ek[e]=t}return ek[e]}function eN(e){if("string"!=typeof e_[e]){var t=(0,f.ZH)(e);e_[e]=t}return e_[e]}var ew=["description","fileName","lineNumber","message","name","number","stack"];function eI(e,t){if("string"==typeof e&&!t)throw new eR(e);if(!e)throw new eR(t.replace(/^ +/gm,"")||"Assertion failed")}function eR(e,t){var i=Error(e);t&&(i.stack=t);for(var n=0;n<ew.length;n++){var r=ew[n];["description","message","stack"].indexOf(r)>-1?this[r]="Mirage: ".concat(i[r]):this[r]=i[r]}}eR.prototype=Object.create(Error.prototype);var eM=function(){function e(t,i){U(this,e),this.modelName=void 0,"object"===Q(t)?(this.modelName=void 0,this.opts=t):(this.modelName=t?eF(t):"",this.opts=i||{}),this.name="",this.ownerModelName=""}return Z(e,[{key:"setSchema",value:function(e){this.schema=e}},{key:"isReflexive",value:function(){var e=!!(this.modelName===this.ownerModelName&&this.opts.inverse),t=!!(void 0===this.opts.inverse&&this.ownerModelName===this.modelName);return e||t}},{key:"isPolymorphic",get:function(){return this.opts.polymorphic}},{key:"type",get:function(){throw Error("Subclasses of Association must implement a getter for type")}},{key:"foreignKey",get:function(){return this.getForeignKey()}},{key:"identifier",get:function(){throw Error("Subclasses of Association must implement a getter for identifier")}}]),e}(),eC={},eO=function(e){X(i,e);var t=eo(i);function i(){return U(this,i),t.apply(this,arguments)}return Z(i,[{key:"identifier",get:function(){if("string"!=typeof eC[this.name]){var e="".concat(eb(this.name),"Id");eC[this.name]=e}return eC[this.name]}},{key:"type",get:function(){return"belongsTo"}},{key:"getForeignKeyArray",value:function(){return[eb(this.ownerModelName),this.getForeignKey()]}},{key:"getForeignKey",value:function(){if("string"!=typeof eC[this.name]){var e="".concat(eb(this.name),"Id");eC[this.name]=e}return eC[this.name]}},{key:"addMethodsToModelClass",value:function(e,t){var i=e.prototype,n=this,r=this.getForeignKey(),o=V({},t,this);i.belongsToAssociations=Object.assign(i.belongsToAssociations,o),Object.keys(i.belongsToAssociations).forEach(function(e){var t=i.belongsToAssociations[e];i.belongsToAssociationFks[t.getForeignKey()]=t}),this.schema.addDependentAssociation(this,this.modelName),i.associationKeys.add(t),i.associationIdKeys.add(r),Object.defineProperty(i,r,{get:function(){this._tempAssociations=this._tempAssociations||{};var e=this._tempAssociations[t];return null===e?null:n.isPolymorphic?e?{id:e.id,type:e.modelName}:this.attrs[r]:e?e.id:this.attrs[r]},set:function(e){var i;null===e?i=null:void 0!==e&&(n.isPolymorphic?(eI("object"===Q(e),"You're setting an ID on the polymorphic association '".concat(n.name,"' but you didn't pass in an object. Polymorphic IDs need to be in the form { type, id }.")),i=n.schema[n.schema.toCollectionName(e.type)].find(e.id)):eI(i=n.schema[n.schema.toCollectionName(n.modelName)].find(e),"Couldn't find ".concat(n.modelName," with id = ").concat(e))),this[t]=i}}),Object.defineProperty(i,t,{get:function(){this._tempAssociations=this._tempAssociations||{};var e=this._tempAssociations[t],i=this[r],o=null;return e?o=e:null!==i&&(o=n.isPolymorphic?n.schema[n.schema.toCollectionName(i.type)].find(i.id):n.schema[n.schema.toCollectionName(n.modelName)].find(i)),o},set:function(e){if(this._tempAssociations=this._tempAssociations||{},this._tempAssociations[t]=e,e&&e.hasInverseFor(n)){var i=e.inverseFor(n);e.associate(this,i)}}}),i["new".concat(eN(t))]=function(){n.isPolymorphic?(e=arguments.length<=0?void 0:arguments[0],i=arguments.length<=1?void 0:arguments[1]):(e=n.modelName,i=arguments.length<=0?void 0:arguments[0]);var e,i,r=n.schema[n.schema.toCollectionName(e)].new(i);return this[t]=r,r},i["create".concat(eN(t))]=function(){n.isPolymorphic?(e=arguments.length<=0?void 0:arguments[0],i=arguments.length<=1?void 0:arguments[1]):(e=n.modelName,i=arguments.length<=0?void 0:arguments[0]);var e,i,r=n.schema[n.schema.toCollectionName(e)].create(i);return this[t]=r,this.save(),r.reload()}}},{key:"disassociateAllDependentsFromTarget",value:function(e){var t,i=this,n=this.ownerModelName;t=this.isPolymorphic?{type:e.modelName,id:e.id}:e.id,this.schema[this.schema.toCollectionName(n)].where(function(e){var n=e[i.getForeignKey()];return!!n&&("object"===Q(n)?n.type===t.type&&n.id===t.id:n===t)}).models.forEach(function(t){t.disassociate(e,i),t.save()})}}]),i}(eM);function eP(e){return Array.isArray(e)?e.map(eP):Object.assign({},e)}var ez=function(){function e(t,i,n){U(this,e),this.name=t,this._records=[],this.identityManager=new n,i&&this.insert(i)}return Z(e,[{key:"all",value:function(){return eP(this._records)}},{key:"insert",value:function(e){var t=this;return Array.isArray(e)?k()(e,function(e){return t._insertRecord(e)}):this._insertRecord(e)}},{key:"find",value:function(e){if(Array.isArray(e))return this._findRecords(e).filter(Boolean).map(eP);var t=this._findRecord(e);return t?eP(t):null}},{key:"findBy",value:function(e){var t=this._findRecordBy(e);return t?eP(t):null}},{key:"where",value:function(e){return this._findRecordsWhere(e).map(eP)}},{key:"firstOrCreate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=es(this.where(e),1)[0];if(i)return i;var n=Object.assign(t,e);return this.insert(n)}},{key:"update",value:function(e,t){var i,n=this;if(void 0===t){t=e;var r=[];return this._records.forEach(function(e){var i=Object.assign({},e);n._updateRecord(e,t),v()(i,e)||r.push(e)}),r}if("number"==typeof e||"string"==typeof e){var o=this._findRecord(e);return this._updateRecord(o,t),o}return Array.isArray(e)?((i=this._findRecords(e)).forEach(function(e){n._updateRecord(e,t)}),i):"object"===Q(e)?((i=this._findRecordsWhere(e)).forEach(function(e){n._updateRecord(e,t)}),i):void 0}},{key:"remove",value:function(e){var t=this;if(void 0===e)this._records=[],this.identityManager.reset();else if("number"==typeof e||"string"==typeof e){var i=this._findRecord(e),n=this._records.indexOf(i);this._records.splice(n,1)}else Array.isArray(e)?this._findRecords(e).forEach(function(e){var i=t._records.indexOf(e);t._records.splice(i,1)}):"object"===Q(e)&&this._findRecordsWhere(e).forEach(function(e){var i=t._records.indexOf(e);t._records.splice(i,1)})}},{key:"_findRecord",value:function(e){return e=e.toString(),this._records.find(function(t){return t.id===e})}},{key:"_findRecordBy",value:function(e){return this._findRecordsWhere(e)[0]}},{key:"_findRecords",value:function(e){return e.map(this._findRecord,this)}},{key:"_findRecordsWhere",value:function(e){var t=this._records,i="object"===Q(e)?function(t){return Object.keys(e).every(function(i){return String(t[i])===String(e[i])})}:e;return t.filter(i)}},{key:"_insertRecord",value:function(e){var t=eP(e);return t&&(void 0===t.id||null===t.id)?t.id=this.identityManager.fetch(t):(t.id=t.id.toString(),this.identityManager.set(t.id)),this._records.push(t),eP(t)}},{key:"_updateRecord",value:function(e,t){var i=t&&Object.prototype.hasOwnProperty.call(t,"id")?t.id.toString():null,n=e.id;if(i&&n!==i)throw Error("Updating the ID of a record is not permitted");for(var r in t)"id"!==r&&(e[r]=t[r])}}]),e}(),ej=function(){function e(t,i){U(this,e),this._collections=[],this.registerIdentityManagers(i),t&&this.loadData(t)}return Z(e,[{key:"loadData",value:function(e){for(var t in e)this.createCollection(t,b()(e[t]))}},{key:"dump",value:function(){return this._collections.reduce(function(e,t){return e[t.name]=t.all(),e},{})}},{key:"createCollection",value:function(e,t){if(this[e])t&&this[e].insert(t);else{var i=this.identityManagerFor(e),n=new ez(e,t,i);Object.defineProperty(this,e,{get:function(){var e=n.all();return["insert","find","findBy","where","update","remove","firstOrCreate"].forEach(function(t){e[t]=function(){return n[t].apply(n,arguments)}}),e}}),Object.defineProperty(this,"_".concat(e),{get:function(){var e=[];return["insert","find","findBy","where","update","remove","firstOrCreate"].forEach(function(t){e[t]=function(){return n[t].apply(n,arguments)}}),e}}),this._collections.push(n)}return this}},{key:"createCollections",value:function(){for(var e=this,t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];i.forEach(function(t){return e.createCollection(t)})}},{key:"emptyData",value:function(){this._collections.forEach(function(e){return e.remove()})}},{key:"identityManagerFor",value:function(e){return this._identityManagers[this._container.inflector.singularize(e)]||this._identityManagers.application||ey}},{key:"registerIdentityManagers",value:function(e){this._identityManagers=e||{}}}]),e}(),eS=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];U(this,e),eI(t&&"string"==typeof t,"You must pass a `modelName` into a Collection"),this.modelName=t,this.models=i}return Z(e,[{key:"length",get:function(){return this.models.length}},{key:"update",value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return A().apply(void 0,[this.models,"update"].concat(t)),this}},{key:"save",value:function(){return A()(this.models,"save"),this}},{key:"reload",value:function(){return A()(this.models,"reload"),this}},{key:"destroy",value:function(){return A()(this.models,"destroy"),this}},{key:"add",value:function(e){return this.models.push(e),this}},{key:"remove",value:function(e){var t=this.models.find(function(t){return t.toString()===e.toString()});if(t){var i=this.models.indexOf(t);this.models.splice(i,1)}return this}},{key:"includes",value:function(e){return this.models.some(function(t){return t.toString()===e.toString()})}},{key:"filter",value:function(t){var i=this.models.filter(t);return new e(this.modelName,i)}},{key:"sort",value:function(t){var i=this.models.concat().sort(t);return new e(this.modelName,i)}},{key:"slice",value:function(){var t,i=(t=this.models).slice.apply(t,arguments);return new e(this.modelName,i)}},{key:"mergeCollection",value:function(e){return this.models=this.models.concat(e.models),this}},{key:"toString",value:function(){return"collection:".concat(this.modelName,"(").concat(this.models.map(function(e){return e.id}).join(","),")")}}]),e}(),eT=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];U(this,e),this.models=t}return Z(e,[{key:"length",get:function(){return this.models.length}},{key:"update",value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return A().apply(void 0,[this.models,"update"].concat(t)),this}},{key:"destroy",value:function(){return A()(this.models,"destroy"),this}},{key:"save",value:function(){return A()(this.models,"save"),this}},{key:"reload",value:function(){return A()(this.models,"reload"),this}},{key:"add",value:function(e){return this.models.push(e),this}},{key:"remove",value:function(e){var t=this.models.find(function(t){return v()(t.attrs,e.attrs)});if(t){var i=this.models.indexOf(t);this.models.splice(i,1)}return this}},{key:"includes",value:function(e){return this.models.some(function(t){return v()(t.attrs,e.attrs)})}},{key:"filter",value:function(t){return new e(this.models.filter(t))}},{key:"sort",value:function(t){return new e(this.models.concat().sort(t))}},{key:"slice",value:function(){var t,i=(t=this.models).slice.apply(t,arguments);return new e(i)}},{key:"mergeCollection",value:function(e){return this.models=this.models.concat(e.models),this}},{key:"toString",value:function(){return"collection:".concat(this.modelName,"(").concat(this.models.map(function(e){return e.id}).join(","),")")}}]),e}(),eE={},eK=function(e){X(i,e);var t=eo(i);function i(){return U(this,i),t.apply(this,arguments)}return Z(i,[{key:"identifier",get:function(){if("string"!=typeof eE[this.name]){var e="".concat(eb(this._container.inflector.singularize(this.name)),"Ids");eE[this.name]=e}return eE[this.name]}},{key:"type",get:function(){return"hasMany"}},{key:"getForeignKeyArray",value:function(){return[eb(this.ownerModelName),this.getForeignKey()]}},{key:"getForeignKey",value:function(){if("string"!=typeof eE[this.name]){var e="".concat(this._container.inflector.singularize(eb(this.name)),"Ids");eE[this.name]=e}return eE[this.name]}},{key:"addMethodsToModelClass",value:function(e,t){var i=e.prototype,n=this,r=this.getForeignKey(),o=V({},t,this);i.hasManyAssociations=Object.assign(i.hasManyAssociations,o),Object.keys(i.hasManyAssociations).forEach(function(e){var t=i.hasManyAssociations[e];i.hasManyAssociationFks[t.getForeignKey()]=t}),this.schema.addDependentAssociation(this,this.modelName),i.associationKeys.add(t),i.associationIdKeys.add(r),Object.defineProperty(i,r,{get:function(){this._tempAssociations=this._tempAssociations||{};var e=this._tempAssociations[t];return e?n.isPolymorphic?e.models.map(function(e){return{type:e.modelName,id:e.id}}):e.models.map(function(e){return e.id}):this.attrs[r]||[]},set:function(e){var i;null===e?i=[]:void 0!==e&&(eI(Array.isArray(e),"You must pass an array in when setting ".concat(r," on ").concat(this)),n.isPolymorphic?(eI(e.every(function(e){return"object"===Q(e)&&void 0!==Q(e.type)&&void 0!==Q(e.id)}),"You must pass in an array of polymorphic identifiers (objects of shape { type, id }) when setting ".concat(r," on ").concat(this)),i=new eT(e.map(function(e){var t=e.type,i=e.id;return n.schema[n.schema.toCollectionName(t)].find(i)}))):i=n.schema[n.schema.toCollectionName(n.modelName)].find(e)),this[t]=i}}),Object.defineProperty(i,t,{get:function(){this._tempAssociations=this._tempAssociations||{};var e=null;return this._tempAssociations[t]?e=this._tempAssociations[t]:(e=n.isPolymorphic?new eT(this[r]?this[r].map(function(e){var t=e.type,i=e.id;return n.schema[n.schema.toCollectionName(t)].find(i)}):n.modelName):this[r]?n.schema[n.schema.toCollectionName(n.modelName)].find(this[r]):new eS(n.modelName),this._tempAssociations[t]=e),e},set:function(e){var i,r=this;(e instanceof eS||e instanceof eT)&&(e=e.models),e=e?w()(e):[],this._tempAssociations=this._tempAssociations||{},i=n.isPolymorphic?new eT(e):new eS(n.modelName,e),this._tempAssociations[t]=i,e.forEach(function(e){if(e.hasInverseFor(n)){var t=e.inverseFor(n);e.associate(r,t)}})}}),i["new".concat(eN(eb(this._container.inflector.singularize(n.name))))]=function(){n.isPolymorphic?(e=arguments.length<=0?void 0:arguments[0],i=arguments.length<=1?void 0:arguments[1]):(e=n.modelName,i=arguments.length<=0?void 0:arguments[0]);var e,i,r=n.schema[n.schema.toCollectionName(e)].new(i),o=this[t].models;return o.push(r),this[t]=o,r},i["create".concat(eN(eb(this._container.inflector.singularize(n.name))))]=function(){n.isPolymorphic?(e=arguments.length<=0?void 0:arguments[0],i=arguments.length<=1?void 0:arguments[1]):(e=n.modelName,i=arguments.length<=0?void 0:arguments[0]);var e,i,r=n.schema[n.schema.toCollectionName(e)].create(i),o=this[t].models;return o.push(r),this[t]=o,this.save(),r.reload()}}},{key:"disassociateAllDependentsFromTarget",value:function(e){var t,i=this,n=this.ownerModelName;t=this.isPolymorphic?{type:e.modelName,id:e.id}:e.id,this.schema[this.schema.toCollectionName(n)].where(function(e){var n=e[i.getForeignKey()];return n&&n.find(function(e){return"object"===Q(e)?e.type===t.type&&e.id===t.id:e===t})}).models.forEach(function(t){t.disassociate(e,i),t.save()})}}]),i}(eM),eq={},ex=function(){function e(){U(this,e)}return Z(e,[{key:"getModelClassFromPath",value:function(e){if(e){if("string"!=typeof eq[e]){for(var t,i=e.split("/"),n=i.length-1;n>=0;n--){var r=i[n];if(r.length&&":"!==r[0]){t=r;break}}eq[e]=eF(eb(this._container.inflector.singularize(t)))}return eq[e]}}},{key:"_getIdForRequest",value:function(e,t){var i;return e&&e.params&&e.params.id?i=e.params.id:t&&t.data&&t.data.id&&(i=t.data.id),i}},{key:"_getJsonApiDocForRequest",value:function(e,t){var i;return e&&e.requestBody&&(i=JSON.parse(e.requestBody)),this.serializerOrRegistry.normalize(i,t)}},{key:"_getAttrsForRequest",value:function(e,t){var i=this,n=this._getJsonApiDocForRequest(e,t),r=this._getIdForRequest(e,n),o={};return eI(n.data&&(n.data.attributes||n.data.type||n.data.relationships),"You're using a shorthand or #normalizedRequestAttrs, but your serializer's normalize function did not return a valid JSON:API document. Consult the docs for the normalize hook on the Serializer class."),n.data.attributes&&(o=Object.keys(n.data.attributes).reduce(function(e,t){return e[eb(t)]=n.data.attributes[t],e},{})),n.data.relationships&&Object.keys(n.data.relationships).forEach(function(r){var s,a=n.data.relationships[r],c=i.schema.modelClassFor(t).associationFor(eb(r));eI(c,"You're passing the relationship '".concat(r,"' to the '").concat(t,"' model via a ").concat(e.method," to '").concat(e.url,"', but you did not define the '").concat(r,"' association on the '").concat(t,"' model.")),s=c.isPolymorphic?a.data:c instanceof eK?a.data&&a.data.map(function(e){return e.id}):a.data&&a.data.id,o[c.identifier]=s},{}),r&&(o.id=r),o}},{key:"_getAttrsForFormRequest",value:function(e){var t=e.requestBody;return eI(t&&"string"==typeof t,"You're using the helper method #normalizedFormData, but the request body is empty or not a valid url encoded string."),t.split("&").reduce(function(e,t){var i=es(t.split("="),2),n=i[0],r=i[1];return e[n]=decodeURIComponent(r.replace(/\+/g," ")),e},{})}}]),e}(),eD=function(e){X(i,e);var t=eo(i);function i(e,n,r,o,s){var a;return U(this,i),(a=t.call(this,s)).schema=e,a.serializerOrRegistry=n,a.userFunction=r,a.path=o,a}return Z(i,[{key:"handle",value:function(e){return this.userFunction(this.schema,e)}},{key:"setRequest",value:function(e){this.request=e}},{key:"serialize",value:function(e,t){return(t?this.serializerOrRegistry.serializerFor(t,{explicit:!0}):this.serializerOrRegistry).serialize(e,this.request)}},{key:"normalizedRequestAttrs",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=this.path,n=this.request,r=this.request.requestHeaders,o={};for(var s in r)o[s.toLowerCase()]=r[s];return/x-www-form-urlencoded/.test(o["content-type"])?e=this._getAttrsForFormRequest(n):(t?eI(eF(t)===t,"You called normalizedRequestAttrs('".concat(t,"'), but normalizedRequestAttrs was intended to be used with the dasherized version of the model type. Please change this to normalizedRequestAttrs('").concat(eF(t),"').")):t=this.getModelClassFromPath(i),eI(this.schema.hasModelForModelName(t),"You're using a shorthand or the #normalizedRequestAttrs helper but the detected model of '".concat(t,"' does not exist. You might need to pass in the correct modelName as the first argument to #normalizedRequestAttrs.")),e=this._getAttrsForRequest(n,t)),e}}]),i}(ex),eY=function(){function e(t,i,n){U(this,e),this.schema=t,this.serializerOrRegistry=i,this.object=n}return Z(e,[{key:"handle",value:function(){return this.object}}]),e}(),eH=function(e){X(i,e);var t=eo(i);function i(e,n,r,o){var s,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};U(this,i),s=t.call(this),r=r||s.getModelClassFromPath(o),s.schema=e,s.serializerOrRegistry=n,s.shorthand=r,s.options=a;var c=Array.isArray(r)?"array":Q(r);if("string"===c){var u=s.schema[s.schema.toCollectionName(r)];s.handle=function(e){return s.handleStringShorthand(e,u)}}else if("array"===c){var l=r.map(function(e){return s.schema[s.schema.toCollectionName(e)]});s.handle=function(e){return s.handleArrayShorthand(e,l)}}return s}return i}(ex),eB=function(e){X(i,e);var t=eo(i);function i(){return U(this,i),t.apply(this,arguments)}return Z(i,[{key:"handleStringShorthand",value:function(e,t){var i=eb(this.shorthand);eI(t,"The route handler for ".concat(e.url," is trying to access the ").concat(i," model, but that model doesn't exist."));var n=this._getIdForRequest(e);if(n)return t.find(n)||new ep(404);if(this.options.coalesce){var r=this.serializerOrRegistry.getCoalescedIds(e,i);if(r)return t.find(r)}return t.all()}},{key:"handleArrayShorthand",value:function(e,t){var i=this.shorthand;return eI(!this._getIdForRequest(e)||this._container.inflector.singularize(i[0])!==i[0],"It looks like you're using the \"Single record with\n      related records\" version of the array shorthand, in addition to opting\n      in to the model layer. This shorthand was made when there was no\n      serializer layer. Now that you're using models, please ensure your\n      relationships are defined, and create a serializer for the parent\n      model, adding the relationships there."),t.map(function(e){return e.all()})}}]),i}(eH),eW=function(e){X(i,e);var t=eo(i);function i(){return U(this,i),t.apply(this,arguments)}return Z(i,[{key:"handleStringShorthand",value:function(e,t){var i=eb(this.shorthand);eI(t,"The route handler for ".concat(e.url," is trying to access the ").concat(i," model, but that model doesn't exist."));var n=this._getAttrsForRequest(e,t.camelizedModelName);return t.create(n)}}]),i}(eH),eL=function(e){X(i,e);var t=eo(i);function i(){return U(this,i),t.apply(this,arguments)}return Z(i,[{key:"handleStringShorthand",value:function(e,t){var i=eb(this.shorthand);eI(t,"The route handler for ".concat(e.url," is trying to access the ").concat(i," model, but that model doesn't exist."));var n=this._getIdForRequest(e),r=t.find(n);if(!r)return new ep(404);var o=this._getAttrsForRequest(e,t.camelizedModelName);return r.update(o)}}]),i}(eH),eG=function(e){X(i,e);var t=eo(i);function i(){return U(this,i),t.apply(this,arguments)}return Z(i,[{key:"handleStringShorthand",value:function(e,t){var i=eb(this.shorthand);eI(t,"The route handler for ".concat(e.url," is trying to access the ").concat(i," model, but that model doesn't exist."));var n=this._getIdForRequest(e),r=t.find(n);if(!r)return new ep(404);r.destroy()}},{key:"handleArrayShorthand",value:function(e,t){var i=this,n=this._getIdForRequest(e),r=t[0].find(n);t.slice(1).map(function(e){return i._container.inflector.pluralize(e.camelizedModelName)}).forEach(function(e){return r[e].destroy()}),r.destroy()}}]),i}(eH),eJ=function(e){X(i,e);var t=eo(i);function i(){return U(this,i),t.apply(this,arguments)}return Z(i,[{key:"handleStringShorthand",value:function(e,t){var i=eb(this.shorthand);eI(t,"The route handler for ".concat(e.url," is trying to access the ").concat(i," model, but that model doesn't exist."));var n=this._getIdForRequest(e);return new ep(n?t.find(n)?204:404:this.options.coalesce&&e.queryParams&&e.queryParams.ids?t.find(e.queryParams.ids)?204:404:204)}}]),i}(eH),eQ={get:200,put:204,post:201,delete:204},eU=function(){function e(t){var i,n,r,o,s,a,c,u,l,h=t.schema,d=t.verb,f=t.rawHandler,y=t.customizedCode,m=t.options,p=t.path,v=t.serializerOrRegistry,g=t.middleware;U(this,e),this.verb=d,this.customizedCode=y,this.serializerOrRegistry=v,this.middleware=g||[],this.handler=(r=(i={verb:d,schema:h,path:p,serializerOrRegistry:v,rawHandler:f,options:m}).verb,o=i.schema,s=i.serializerOrRegistry,a=i.path,u=[o,s,c=i.rawHandler,a,i.options,i.middleware],"function"===(l=Q(c))?n=en(eD,u):"object"===l&&c?n=en(eY,u):"get"===r?n=en(eB,u):"post"===r?n=en(eW,u):"put"===r||"patch"===r?n=en(eL,u):"delete"===r?n=en(eG,u):"head"===r&&(n=en(eJ,u)),n)}return Z(e,[{key:"handle",value:function(e){var t=this;return this._getMirageResponseForRequest(e,this.middleware).then(function(i){return t.serialize(i,e)}).then(function(e){return e.toRackResponse()})}},{key:"_getMirageResponseForRequest",value:function(e){var t,i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];try{this.handler instanceof eD&&this.handler.setRequest(e),t=this.handleWithMiddleware(e,[].concat(ea(n),[function(e,t){return i.handler.handle(t)}]))}catch(i){t=i instanceof eR?new ep(500,{},i):new ep(500,{},{message:i.message||i,stack:"Mirage: Your ".concat(e.method," handler for the url ").concat(e.url," threw an error:\n\n").concat(i.stack||i)})}return this._toMirageResponse(t)}},{key:"handleWithMiddleware",value:function(e,t){var i=this,n=ec(t)||eu(t)||el(t)||ed(),r=n[0],o=n.slice(1);return r(this.schema,e,function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e;return i.handleWithMiddleware(t,o)})}},{key:"_toMirageResponse",value:function(e){var t=this;return new Promise(function(i,n){Promise.resolve(e).then(function(n){i(n instanceof ep?e:new ep(t._getCodeForResponse(n),{},n))}).catch(n)})}},{key:"_getCodeForResponse",value:function(e){var t;return this.customizedCode?t=this.customizedCode:204===(t=eQ[this.verb])&&void 0!==e&&""!==e&&(t=200),t}},{key:"serialize",value:function(e,t){return e.data=this.serializerOrRegistry.serialize(e.data,t),e}}]),e}();function e$(e,t){var i=function(t){X(n,t);var i=eo(n);function n(){U(this,n);for(var t,r,o=arguments.length,s=Array(o),a=0;a<o;a++)s[a]=arguments[a];return t=i.call.apply(i,[this].concat(s)),e&&R()(e,"constructor")&&(r=e.constructor).call.apply(r,[er(t)].concat(s)),t}return n}(this);return Object.assign(i,this,t),e&&Object.assign(i.prototype,e),i}var eZ=function(){function e(t,i,n,r){var o=this;return U(this,e),eI(t,"A model requires a schema"),eI(i,"A model requires a modelName"),this._schema=t,this.modelName=i,this.fks=r||[],this.attrs={},n=n||{},this.fks.forEach(function(e){o.attrs[e]=void 0!==n[e]?n[e]:null}),Object.keys(n).forEach(function(e){var t=n[e];o._validateAttr(e,t),o._setupAttr(e,t),o._setupRelationship(e,t)}),this}return Z(e,[{key:"save",value:function(){var e=this._schema.toInternalCollectionName(this.modelName);return this.isNew()?(this.attrs=this._schema.db[e].insert(this.attrs),this._definePlainAttribute("id")):(this._schema.isSaving[this.toString()]=!0,this._schema.db[e].update(this.attrs.id,this.attrs)),this._saveAssociations(),this._schema.isSaving[this.toString()]=!1,this}},{key:"update",value:function(e,t){var i;return null==e||("object"===Q(e)?i=e:(i={})[e]=t,Object.keys(i).forEach(function(e){this.associationKeys.has(e)||this.associationIdKeys.has(e)||this._definePlainAttribute(e),this[e]=i[e]},this),this.save()),this}},{key:"destroy",value:function(){if(this.isSaved()){this._disassociateFromDependents();var e=this._schema.toInternalCollectionName(this.modelName);this._schema.db[e].remove(this.attrs.id)}}},{key:"isNew",value:function(){var e=!1;if(void 0!==this.attrs.id&&null!==this.attrs.id){var t=this._schema.toInternalCollectionName(this.modelName);this._schema.db[t].find(this.attrs.id)&&(e=!0)}return!e}},{key:"isSaved",value:function(){return!this.isNew()}},{key:"reload",value:function(){if(this.id){var e=this._schema.toInternalCollectionName(this.modelName),t=this._schema.db[e].find(this.id);Object.keys(t).filter(function(e){return"id"!==e}).forEach(function(e){this.attrs[e]=t[e]},this)}return this._tempAssociations={},this}},{key:"toJSON",value:function(){return function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?J(Object(i),!0).forEach(function(t){V(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):J(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}({},this.attrs)}},{key:"associations",get:function(){return this._schema.associationsFor(this.modelName)}},{key:"associationFor",value:function(e){return this.associations[e]}},{key:"inverseFor",value:function(e){return this._explicitInverseFor(e)||this._implicitInverseFor(e)}},{key:"_explicitInverseFor",value:function(e){this._checkForMultipleExplicitInverses(e);var t=this._schema.associationsFor(this.modelName),i=e.opts.inverse,n=i?t[i]:null,r=n&&n.isPolymorphic,o=n&&n.modelName===e.ownerModelName;return n&&n.opts.inverse&&n.opts.inverse!==e.name&&eI(!1,"You specified an inverse of ".concat(i," for ").concat(e.name,", but it does not match ").concat(n.modelName," ").concat(n.name,"'s inverse")),r||o?n:null}},{key:"_checkForMultipleExplicitInverses",value:function(e){var t=this._schema.associationsFor(this.modelName);eI(Object.keys(t).filter(function(i){var n=t[i],r=e.ownerModelName===n.modelName,o=e.name===n.opts.inverse;return r&&o}).length<=1,"The ".concat(this.modelName," model has defined multiple explicit inverse associations for the ").concat(e.ownerModelName,".").concat(e.name," association."))}},{key:"_implicitInverseFor",value:function(e){var t=this,i=this._schema.associationsFor(this.modelName),n=e.ownerModelName;return C()(i).filter(function(e){return e.modelName===n}).reduce(function(i,n){var r=n.opts.inverse,o=r===e.name;return(void 0===r||o)&&(eI(!i,"The ".concat(t.modelName," model has multiple possible inverse associations for the ").concat(e.ownerModelName,".").concat(e.name," association.")),i=n),i},null)}},{key:"hasInverseFor",value:function(e){return!!this.inverseFor(e)}},{key:"alreadyAssociatedWith",value:function(t,i){var n=this[i.name];if(n&&t)return n instanceof e?n.isSaved()&&t.isSaved()?n.toString()===t.toString():n===t:n.includes(t)}},{key:"associate",value:function(e,t){if(!this.alreadyAssociatedWith(e,t)){var i=t.name;t instanceof eK?this[i].includes(e)||this[i].add(e):this[i]=e}}},{key:"disassociate",value:function(e,t){var i,n=t.getForeignKey();if(t instanceof eK){if(t.isPolymorphic){var r=this[n].find(function(t){var i=t.type,n=t.id;return i===e.modelName&&n===e.id});i=r&&this[n].indexOf(r)}else i=this[n].map(function(e){return e.toString()}).indexOf(e.id.toString());i>-1&&this.attrs[n].splice(i,1)}else this.attrs[n]=null}},{key:"isSaving",get:function(){return this._schema.isSaving[this.toString()]}},{key:"_setupAttr",value:function(e,t){this.associationKeys.has(e)||this.associationIdKeys.has(e)||(this.attrs[e]=t,this._definePlainAttribute(e))}},{key:"_definePlainAttribute",value:function(e){var t=Object.getOwnPropertyDescriptor(this,e);t&&t.get||(Object.prototype.hasOwnProperty.call(this.attrs,e)||(this.attrs[e]=null),Object.defineProperty(this,e,{get:function(){return this.attrs[e]},set:function(t){this.attrs[e]=t}}))}},{key:"_setupRelationship",value:function(e,t){var i=this.associationIdKeys.has(e)||this.fks.includes(e),n=this.associationKeys.has(e);i&&(null!=t&&this._validateForeignKeyExistsInDatabase(e,t),this.attrs[e]=t),n&&(this[e]=t)}},{key:"_validateAttr",value:function(t,i){if(this.associationKeys.has(t)){var n=this.associationFor(t),r=null===i;if(n instanceof eK){var o=i instanceof eS||i instanceof eT,s=Array.isArray(i)&&i.every(function(t){return t instanceof e});eI(o||s||r,"You're trying to create a ".concat(this.modelName,' model and you passed in "').concat(i,'" under the ').concat(t," key, but that key is a HasMany relationship. You must pass in a Collection, PolymorphicCollection, array of Models, or null."))}else n instanceof eO&&eI(i instanceof e||r,"You're trying to create a ".concat(this.modelName,' model and you passed in "').concat(i,'" under the ').concat(t," key, but that key is a BelongsTo relationship. You must pass in a Model or null."))}if(this.associationIdKeys.has(t)&&t.endsWith("Ids")){var a=Array.isArray(i),c=null===i;eI(a||c,"You're trying to create a ".concat(this.modelName,' model and you passed in "').concat(i,'" under the ').concat(t," key, but that key is a foreign key for a HasMany relationship. You must pass in an array of ids or null."))}var u=i instanceof e||i instanceof eS||i instanceof eT,l=Array.isArray(i)&&i.length&&i.every(function(t){return t instanceof e});(u||l)&&eI(this.associationKeys.has(t),"You're trying to create a ".concat(this.modelName," model and you passed in a ").concat(i.toString()," under the ").concat(t," key, but you haven't defined that key as an association on your model."))}},{key:"_validateForeignKeyExistsInDatabase",value:function(e,t){var i=this;if(Array.isArray(t)){var n,r=this.hasManyAssociationFks[e];r.isPolymorphic?(n=t.map(function(e){var t=e.type,n=e.id;return i._schema.db[i._schema.toInternalCollectionName(t)].find(n)}),n=w()(n)):n=this._schema.db[this._schema.toInternalCollectionName(r.modelName)].find(t);var o=r.isPolymorphic?t.map(function(e){return"".concat(e.type,":").concat(e.id)}).join(","):t;eI(n.length===t.length,"You're instantiating a ".concat(this.modelName," that has a ").concat(e," of ").concat(o,", but some of those records don't exist in the database."))}else{var s,a=this.belongsToAssociationFks[e];s=a.isPolymorphic?this._schema.db[this._schema.toInternalCollectionName(t.type)].find(t.id):this._schema.db[this._schema.toInternalCollectionName(a.modelName)].find(t);var c=a.isPolymorphic?"".concat(t.type,":").concat(t.id):t;eI(s,"You're instantiating a ".concat(this.modelName," that has a ").concat(e," of ").concat(c,", but that record doesn't exist in the database."))}}},{key:"_saveAssociations",value:function(){this._saveBelongsToAssociations(),this._saveHasManyAssociations()}},{key:"_saveBelongsToAssociations",value:function(){var e=this;C()(this.belongsToAssociations).forEach(function(t){e._disassociateFromOldInverses(t),e._saveNewAssociates(t),e._associateWithNewInverses(t)})}},{key:"_saveHasManyAssociations",value:function(){var e=this;C()(this.hasManyAssociations).forEach(function(t){e._disassociateFromOldInverses(t),e._saveNewAssociates(t),e._associateWithNewInverses(t)})}},{key:"_disassociateFromOldInverses",value:function(e){e instanceof eK?this._disassociateFromHasManyInverses(e):e instanceof eO&&this._disassociateFromBelongsToInverse(e)}},{key:"_disassociateFromHasManyInverses",value:function(e){var t=this,i=e.getForeignKey(),n=this._tempAssociations&&this._tempAssociations[e.name],r=this.attrs[i];n&&r&&(e.isPolymorphic?r.map(function(e){var i=e.type,n=e.id;return t._schema[t._schema.toCollectionName(i)].find(n)}):this._schema[this._schema.toCollectionName(e.modelName)].find(r||[]).models).filter(function(t){return!t.isSaving&&!n.includes(t)&&t.hasInverseFor(e)}).forEach(function(i){var n=i.inverseFor(e);i.disassociate(t,n),i.save()})}},{key:"_disassociateFromBelongsToInverse",value:function(e){var t,i=e.getForeignKey(),n=this._tempAssociations&&this._tempAssociations[e.name],r=this.attrs[i];if(void 0!==n&&r&&(t=e.isPolymorphic?this._schema[this._schema.toCollectionName(r.type)].find(r.id):this._schema[this._schema.toCollectionName(e.modelName)].find(r)).hasInverseFor(e)){var o=t.inverseFor(e);t.disassociate(this,o),t._updateInDb(t.attrs)}}},{key:"_disassociateFromDependents",value:function(){var e=this;this._schema.dependentAssociationsFor(this.modelName).forEach(function(t){t.disassociateAllDependentsFromTarget(e)})}},{key:"_saveNewAssociates",value:function(e){var t,i=e.getForeignKey(),n=this._tempAssociations&&this._tempAssociations[e.name];void 0!==n&&(this.__isSavingNewChildren=!0,delete this._tempAssociations[e.name],n instanceof eS?(n.models.filter(function(e){return!e.isSaving}).forEach(function(e){e.save()}),this._updateInDb(V({},i,n.models.map(function(e){return e.id})))):n instanceof eT?(n.models.filter(function(e){return!e.isSaving}).forEach(function(e){e.save()}),this._updateInDb(V({},i,n.models.map(function(e){return{type:e.modelName,id:e.id}})))):null===n?this._updateInDb(V({},i,null)):this.equals(n)?this._updateInDb(V({},i,this.id)):n.isSaving||(n.save(),this._syncTempAssociations(n),t=e.isPolymorphic?{id:n.id,type:n.modelName}:n.id,this._updateInDb(V({},i,t))),this.__isSavingNewChildren=!1)}},{key:"_associateWithNewInverses",value:function(t){var i=this;if(!this.__isSavingNewChildren){var n=this[t.name];n instanceof e?this._associateModelWithInverse(n,t):(n instanceof eS||n instanceof eT)&&n.models.forEach(function(e){i._associateModelWithInverse(e,t)}),delete this._tempAssociations[t.name]}}},{key:"_associateModelWithInverse",value:function(e,t){var i=this;if(e.hasInverseFor(t)){var n=e.inverseFor(t),r=n.getForeignKey(),o=this.id;if(n instanceof eO)s=n.isPolymorphic?{type:this.modelName,id:o}:o,this._schema.db[this._schema.toInternalCollectionName(e.modelName)].update(e.id,V({},r,s));else{var s,a,c,u=this._schema.db[this._schema.toInternalCollectionName(e.modelName)],l=Object.assign([],u.find(e.id)[n.getForeignKey()]||[]);n.isPolymorphic?(a={type:this.modelName,id:o},c=l.some(function(e){return e.type==i.modelName&&e.id==o})):(a=o,c=l.includes(o)),c||l.push(a),u.update(e.id,V({},r,l))}}}},{key:"_updateInDb",value:function(e){this.attrs=this._schema.db[this._schema.toInternalCollectionName(this.modelName)].update(this.attrs.id,e)}},{key:"_syncTempAssociations",value:function(e){var t=this;Object.keys(this._tempAssociations).forEach(function(i){t._tempAssociations[i]&&t._tempAssociations[i].toString()===e.toString()&&(t._tempAssociations[i]=e)})}},{key:"toString",value:function(){var e=this.id?"(".concat(this.id,")"):"";return"model:".concat(this.modelName).concat(e)}},{key:"equals",value:function(e){return this.toString()===e.toString()}}]),e}();eZ.extend=e$,eZ.findBelongsToAssociation=function(e){return this.prototype.belongsToAssociations[e]};var eV=function(){function e(t,i){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};U(this,e),this.registry=t,this.type=i,this.request=r,this.attrs=this.attrs||void 0,this.include=this.include||[],this.root=this.root||void 0,this.embed=this.embed||void 0,this._embedFn=s()(this.embed)?this.embed:function(){return!!n.embed},this.serializeIds=this.serializeIds||void 0,this.primaryKey=this.primaryKey||void 0}return Z(e,[{key:"serialize",value:function(e){return this.primaryResource=e,this.buildPayload(e)}},{key:"normalize",value:function(e){return e}},{key:"buildPayload",value:function(e,t,i,n){if(!e&&P()(t))return n;if(e){var r=es(this.getHashForPrimaryResource(e),2),o=r[0],s=r[1],a=this.isCollection(e)?e.models:[e];return this.buildPayload(void 0,s,a,o)}var c=t.shift(),u=es(this.getHashForIncludedResource(c),2),l=u[0],h=u[1].filter(function(e){return!i.map(function(e){return e.toString()}).includes(e.toString())}).concat(t),d=(this.isCollection(c)?c.models:[c]).concat(i),f=this.mergePayloads(n,l);return this.buildPayload(void 0,h,d,f)}},{key:"getHashForPrimaryResource",value:function(e){var t,i=es(this.getHashForResource(e),2),n=i[0],r=i[1];return this.root?(eI(!(e instanceof eT),"The base Serializer class cannot serialize a top-level PolymorphicCollection when root is true, since PolymorphicCollections have no type."),t=V({},this.serializerFor(e.modelName).keyForResource(e),n)):t=n,[t,r]}},{key:"getHashForIncludedResource",value:function(e){var t,i;if(e instanceof eT)t={},i=e.models;else{var n=this.serializerFor(e.modelName),r=es(n.getHashForResource(e),2),o=r[0],s=r[1],a=n.keyForRelationship(e.modelName);t=Array.isArray(o)?V({},a,o):V({},a,[o]),i=s}return[t,i]}},{key:"getHashForResource",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this;return r&&e.modelName&&(o=this.serializerFor(e.modelName)),[this.isModel(e)?o._hashForModel(e,i,n):e.models.map(function(e){var r=o;return r||(r=t.serializerFor(e.modelName)),r._hashForModel(e,i,n)}),T()(w()(d()(o.getKeysForIncluded().map(function(i){return t.isCollection(e)?e.models.map(function(e){return e[i]}):e[i]}))),function(e){return e.toString()})]}},{key:"mergePayloads",value:function(e,t){var i,n=es(Object.keys(t),1)[0];return e[n]?(i=e)[n]=e[n].concat(t[n]):i=Object.assign(e,t),i}},{key:"keyForResource",value:function(e){var t=e.modelName;return this.isModel(e)?this.keyForModel(t):this.keyForCollection(t)}},{key:"keyForModel",value:function(e){return eb(e)}},{key:"keyForCollection",value:function(e){return this._container.inflector.pluralize(this.keyForModel(e))}},{key:"_hashForModel",value:function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this._attrsForModel(e);if(t&&e.fks.forEach(function(e){delete r[e]}),this.embed){var o=Object.assign({},n);o[e.modelName]=o[e.modelName]||{},o[e.modelName][e.id]=!0,this.getKeysForEmbedded().forEach(function(t){var n=e[t];if(n&&!j()(o,"".concat(n.modelName,".").concat(n.id))){var s=es(i.getHashForResource(n,!0,o,!0),1)[0];if(r[i.keyForEmbeddedRelationship(t)]=s,i.isModel(n)){var a="".concat(eb(t),"Id");delete r[a]}}})}return this._maybeAddAssociationIds(e,r)}},{key:"_attrsForModel",value:function(e){var t={};return t=this.attrs?this.attrs.reduce(function(t,i){return t[i]=e[i],t},{}):Object.assign(t,e.attrs),e.fks.forEach(function(e){return delete t[e]}),this._formatAttributeKeys(t)}},{key:"_maybeAddAssociationIds",value:function(e,t){var i=this,n=Object.assign({},t);return"always"===this.serializeIds?ea(e.associationKeys).filter(function(e){return!i._embedFn(e)}).forEach(function(t){var r=e[t],o=e.associationFor(t);if(i.isCollection(r))n[i.keyForRelationshipIds(t)]=e["".concat(i._container.inflector.singularize(t),"Ids")];else if(i.isModel(r)&&o.isPolymorphic){var s=i.keyForPolymorphicForeignKeyType(t),a=i.keyForPolymorphicForeignKeyId(t);n[s]=e["".concat(t,"Id")].type,n[a]=e["".concat(t,"Id")].id}else r&&(n[i.keyForForeignKey(t)]=e["".concat(t,"Id")])}):"included"===this.serializeIds&&this.getKeysForIncluded().forEach(function(t){var r=e[t],o=e.associationFor(t);if(i.isCollection(r))n[i.keyForRelationshipIds(t)]=e["".concat(i._container.inflector.singularize(t),"Ids")];else if(i.isModel(r)&&o.isPolymorphic){var s=i.keyForPolymorphicForeignKeyType(t),a=i.keyForPolymorphicForeignKeyId(t);n[s]=e["".concat(t,"Id")].type,n[a]=e["".concat(t,"Id")].id}else i.isModel(r)&&(n[i.keyForForeignKey(t)]=e["".concat(t,"Id")])}),n}},{key:"keyForAttribute",value:function(e){return"id"===e?this.keyForId():e}},{key:"keyForRelationship",value:function(e){return eb(this._container.inflector.pluralize(e))}},{key:"keyForEmbeddedRelationship",value:function(e){return eb(e)}},{key:"keyForRelationshipIds",value:function(e){return"".concat(this._container.inflector.singularize(eb(e)),"Ids")}},{key:"keyForForeignKey",value:function(e){return"".concat(eb(e),"Id")}},{key:"keyForPolymorphicForeignKeyId",value:function(e){return"".concat(eb(e),"Id")}},{key:"keyForPolymorphicForeignKeyType",value:function(e){return"".concat(eb(e),"Type")}},{key:"isModel",value:function(e){return e instanceof eZ}},{key:"isCollection",value:function(e){return e instanceof eS||e instanceof eT}},{key:"isModelOrCollection",value:function(e){return this.isModel(e)||this.isCollection(e)}},{key:"serializerFor",value:function(e){return this.registry.serializerFor(e)}},{key:"getAssociationKeys",value:function(){return s()(this.include)?this.include(this.request,this.primaryResource):this.include}},{key:"getKeysForEmbedded",value:function(){var e=this;return this.getAssociationKeys().filter(function(t){return e._embedFn(t)})}},{key:"getKeysForIncluded",value:function(){var e=this;return this.getAssociationKeys().filter(function(t){return!e._embedFn(t)})}},{key:"schema",get:function(){return this.registry.schema}},{key:"keyForId",value:function(){return this.primaryKey}},{key:"valueForId",value:function(e){return e}},{key:"_formatAttributeKeys",value:function(e){var t={};for(var i in e){var n=e[i];"id"===i&&(n=this.valueForId(n)),t[this.keyForAttribute(i)]=n}return t}},{key:"getCoalescedIds",value:function(){}}]),e}();eV.prototype.include=[],eV.prototype.root=!0,eV.prototype.embed=!1,eV.prototype.primaryKey="id",eV.prototype.serializeIds="included",eV.extend=e$;var eX=function(e){X(i,e);var t=eo(i);function i(){var e;return U(this,i),e=t.apply(this,arguments),e.alwaysIncludeLinkageData=e.alwaysIncludeLinkageData||void 0,e}return Z(i,[{key:"keyForModel",value:function(e){return eF(e)}},{key:"keyForCollection",value:function(e){return eF(e)}},{key:"keyForAttribute",value:function(e){return eF(e)}},{key:"keyForRelationship",value:function(e){return eF(e)}},{key:"links",value:function(){}},{key:"getHashForPrimaryResource",value:function(e){return this._createRequestedIncludesGraph(e),[{data:this.getHashForResource(e)},this.getAddToIncludesForResource(e)]}},{key:"getHashForIncludedResource",value:function(e){var t=this.serializerFor(e.modelName).getHashForResource(e),i={included:this.isModel(e)?[t]:t},n=[];return this.hasQueryParamIncludes()||(n=this.getAddToIncludesForResource(e)),[i,n]}},{key:"getHashForResource",value:function(e){var t=this;return this.isModel(e)?this.getResourceObjectForModel(e):e.models.map(function(e){return t.getResourceObjectForModel(e)})}},{key:"getAddToIncludesForResource",value:function(e){var t;return t=this.hasQueryParamIncludes()?this.getQueryParamIncludes():this.serializerFor(e.modelName).getKeysForIncluded(),this.getAddToIncludesForResourceAndPaths(e,t)}},{key:"getAddToIncludesForResourceAndPaths",value:function(e,t){var i=this,n=[];return t.forEach(function(t){var r=t.split("."),o=i.getIncludesForResourceAndPath.apply(i,[e].concat(ea(r)));n.push(o)}),T()(w()(d()(n)),function(e){return e.toString()})}},{key:"getIncludesForResourceAndPath",value:function(e){for(var t=this,i=arguments.length,n=Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];var o=eb(n.shift()),s=[],a=[];if(this.isModel(e)){var c=e[o];this.isModel(c)?a=[c]:this.isCollection(c)&&(a=c.models)}else e.models.forEach(function(e){var i=e[o];t.isModel(i)?a.push(i):t.isCollection(i)&&(a=a.concat(i.models))});return s=s.concat(a),n.length&&a.forEach(function(e){s=s.concat(t.getIncludesForResourceAndPath.apply(t,[e].concat(n)))}),s}},{key:"getResourceObjectForModel",value:function(e){var t=this._attrsForModel(e,!0);delete t.id;var i={type:this.typeKeyForModel(e),id:e.id,attributes:t};return this._maybeAddRelationshipsToResourceObjectForModel(i,e)}},{key:"_maybeAddRelationshipsToResourceObjectForModel",value:function(e,t){var i=this,n={};return t.associationKeys.forEach(function(e){var r=t[e],o=i.keyForRelationship(e),s={};if(i.hasLinksForRelationship(t,e)){var a=i.serializerFor(t.modelName).links(t);s.links=a[e]}if(i.alwaysIncludeLinkageData||i.shouldIncludeLinkageData(e,t)||i._relationshipIsIncludedForModel(e,t)){var c=null;i.isModel(r)?c={type:i.typeKeyForModel(r),id:r.id}:i.isCollection(r)&&(c=r.models.map(function(e){return{type:i.typeKeyForModel(e),id:e.id}})),s.data=c}P()(s)||(n[o]=s)}),P()(n)||(e.relationships=n),e}},{key:"hasLinksForRelationship",value:function(e,t){var i=this.serializerFor(e.modelName),n=i.links&&i.links(e);return n&&null!=n[t]}},{key:"_relationshipIsIncludedForModel",value:function(e,t){if(!this.hasQueryParamIncludes())return this.getKeysForIncluded().includes(e);var i,n=this.request._includesGraph,r=this._graphKeyForModel(t);return n.data[r]?i=n.data[r]:n.included[this._container.inflector.pluralize(t.modelName)]&&(i=n.included[this._container.inflector.pluralize(t.modelName)][r]),i&&i.relationships&&Object.prototype.hasOwnProperty.call(i.relationships,eF(e))}},{key:"_createRequestedIncludesGraph",value:function(e){var t=this,i={data:{}};if(this.isModel(e)){var n=this._graphKeyForModel(e);i.data[n]={},this._addPrimaryModelToRequestedIncludesGraph(i,e)}else this.isCollection(e)&&e.models.forEach(function(e){var n=t._graphKeyForModel(e);i.data[n]={},t._addPrimaryModelToRequestedIncludesGraph(i,e)});this.request._includesGraph=i}},{key:"_addPrimaryModelToRequestedIncludesGraph",value:function(e,t){var i=this;if(this.hasQueryParamIncludes()){var n=this._graphKeyForModel(t);this.getQueryParamIncludes().filter(function(e){return!!e.trim()}).forEach(function(r){e.data[n].relationships=e.data[n].relationships||{};var o,s=r.split(".").map(eF),a=s[0],c=eb(a);eI(t.associationKeys.has(c),'You tried to include "'.concat(a,'" with ').concat(t,' but no association named "').concat(c,'" is defined on the model.'));var u=t[c];o=i.isModel(u)?i._graphKeyForModel(u):i.isCollection(u)?u.models.map(i._graphKeyForModel):null,e.data[n].relationships[a]=o,u&&i._addResourceToRequestedIncludesGraph(e,u,s.slice(1))})}}},{key:"_addResourceToRequestedIncludesGraph",value:function(e,t,i){var n=this;e.included=e.included||{},(this.isCollection(t)?t.models:[t]).forEach(function(t){var r=n._container.inflector.pluralize(t.modelName);e.included[r]=e.included[r]||{},n._addModelToRequestedIncludesGraph(e,t,i)})}},{key:"_addModelToRequestedIncludesGraph",value:function(e,t,i){var n=this._container.inflector.pluralize(t.modelName),r=this._graphKeyForModel(t);e.included[n][r]=e.included[n][r]||{},i.length&&this._addResourceRelationshipsToRequestedIncludesGraph(e,n,r,t,i)}},{key:"_addResourceRelationshipsToRequestedIncludesGraph",value:function(e,t,i,n,r){e.included[t][i].relationships=e.included[t][i].relationships||{};var o,s=r[0],a=n[eb(s)];this.isModel(a)?o=this._graphKeyForModel(a):this.isCollection(a)&&(o=a.models.map(this._graphKeyForModel)),e.included[t][i].relationships[s]=o,a&&this._addResourceToRequestedIncludesGraph(e,a,r.slice(1))}},{key:"_graphKeyForModel",value:function(e){return"".concat(e.modelName,":").concat(e.id)}},{key:"getQueryParamIncludes",value:function(){var e=j()(this,"request.queryParams.include");return e&&!Array.isArray(e)&&(e=e.split(",")),e}},{key:"hasQueryParamIncludes",value:function(){return!!this.getQueryParamIncludes()}},{key:"typeKeyForModel",value:function(e){return eF(this._container.inflector.pluralize(e.modelName))}},{key:"getCoalescedIds",value:function(e){var t=e.queryParams&&e.queryParams["filter[id]"];return"string"==typeof t?t.split(","):t}},{key:"shouldIncludeLinkageData",value:function(e,t){return!1}}]),i}(eV);eX.prototype.alwaysIncludeLinkageData=!1;var e0=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};U(this,e),this.schema=t,this._serializerMap=i}return Z(e,[{key:"normalize",value:function(e,t){return this.serializerFor(t).normalize(e)}},{key:"serialize",value:function(e,t){var i=this;return(this.request=t,this._isModelOrCollection(e))?this.serializerFor(e.modelName).serialize(e,t):Array.isArray(e)&&e.some(this._isCollection)?e.reduce(function(e,n){var r=i.serializerFor(n.modelName);return r.embed?e[i._container.inflector.pluralize(n.modelName)]=r.serialize(n,t):e=Object.assign(e,r.serialize(n,t)),e},{}):e}},{key:"serializerFor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.explicit,n=e&&this._serializerMap&&this._serializerMap[eb(e)];return void 0!==i&&i?eI(!!n,"You passed in ".concat(e," as an explicit serializer type but that serializer doesn't exist.")):eI(!(n=n||this._serializerMap.application||eV)||n.prototype.embed||n.prototype.root||new n instanceof eX,"You cannot have a serializer that sideloads (embed: false) and disables the root (root: false)."),new n(this,e,this.request)}},{key:"_isModel",value:function(e){return e instanceof eZ}},{key:"_isCollection",value:function(e){return e instanceof eS||e instanceof eT}},{key:"_isModelOrCollection",value:function(e){return this._isModel(e)||this._isCollection(e)}},{key:"registerSerializers",value:function(e){var t=this._serializerMap||{};this._serializerMap=Object.assign(t,e)}},{key:"getCoalescedIds",value:function(e,t){return this.serializerFor(t).getCoalescedIds(e)}}]),e}(),e1={},e2={},e4={},e3=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};U(this,e),eI(t,"A schema requires a db"),this.db=t,this._registry={},this._dependentAssociations={polymorphic:[]},this.registerModels(i),this.isSaving={}}return Z(e,[{key:"registerModels",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};K()(t,function(i,n){e.registerModel(n,t[n])})}},{key:"registerModel",value:function(e,t){var i=this,n=eb(e),r=eF(n);t=t.extend(),this._registry[n]=this._registry[n]||{class:null,foreignKeys:[]},this._registry[n].class=t,t.prototype._schema=this,t.prototype.modelName=r,t.prototype.hasManyAssociations={},t.prototype.hasManyAssociationFks={},t.prototype.belongsToAssociations={},t.prototype.belongsToAssociationFks={},t.prototype.associationKeys=new Set,t.prototype.associationIdKeys=new Set,t.prototype.dependentAssociations=[];var o={};for(var s in t.prototype)if(t.prototype[s]instanceof eM){var a=t.prototype[s];a.name=s,a.modelName=a.modelName||this.toModelName(s),a.ownerModelName=r,a.setSchema(this);var c=es(a.getForeignKeyArray(),2),u=c[0],l=c[1];o[u]=o[u]||[],eI(!o[u].includes(l),"Your '".concat(e,"' model definition has multiple possible inverse relationships of type '").concat(u,"'. Please use explicit inverses.")),o[u].push(l),this._addForeignKeyToRegistry(u,l),a.addMethodsToModelClass(t,s)}var h=this.toCollectionName(r);return this.db[h]||this.db.createCollection(h),this[h]={camelizedModelName:n,new:function(e){return i.new(n,e)},create:function(e){return i.create(n,e)},all:function(e){return i.all(n,e)},find:function(e){return i.find(n,e)},findBy:function(e){return i.findBy(n,e)},findOrCreateBy:function(e){return i.findOrCreateBy(n,e)},where:function(e){return i.where(n,e)},none:function(e){return i.none(n,e)},first:function(e){return i.first(n,e)}},this}},{key:"modelFor",value:function(e){return this._registry[e]}},{key:"new",value:function(e,t){return this._instantiateModel(eF(e),t)}},{key:"create",value:function(e,t){return this.new(e,t).save()}},{key:"all",value:function(e){var t=this.collectionForType(e);return this._hydrate(t,eF(e))}},{key:"none",value:function(e){return this._hydrate([],eF(e))}},{key:"find",value:function(e,t){var i=this.collectionForType(e).find(t);return Array.isArray(t)&&eI(i.length===t.length,"Couldn't find all ".concat(this._container.inflector.pluralize(e)," with ids: (").concat(t.join(","),") (found ").concat(i.length," results, but was looking for ").concat(t.length,")")),this._hydrate(i,eF(e))}},{key:"findBy",value:function(e,t){var i=this.collectionForType(e).findBy(t);return this._hydrate(i,eF(e))}},{key:"findOrCreateBy",value:function(e,t){var i=this.collectionForType(e).findBy(t);return i?this._hydrate(i,eF(e)):this.create(e,t)}},{key:"where",value:function(e,t){var i=this.collectionForType(e).where(t);return this._hydrate(i,eF(e))}},{key:"first",value:function(e){var t=this.collectionForType(e)[0];return this._hydrate(t,eF(e))}},{key:"modelClassFor",value:function(e){var t=this._registry[eb(e)];return eI(t,"Model not registered: ".concat(e)),t.class.prototype}},{key:"addDependentAssociation",value:function(e,t){e.isPolymorphic?this._dependentAssociations.polymorphic.push(e):(this._dependentAssociations[t]=this._dependentAssociations[t]||[],this._dependentAssociations[t].push(e))}},{key:"dependentAssociationsFor",value:function(e){var t=this._dependentAssociations[e]||[],i=this._dependentAssociations.polymorphic||[];return t.concat(i)}},{key:"associationsFor",value:function(e){var t=this.modelClassFor(e);return Object.assign({},t.belongsToAssociations,t.hasManyAssociations)}},{key:"hasModelForModelName",value:function(e){return this.modelFor(eb(e))}},{key:"collectionForType",value:function(e){var t=this.toCollectionName(e);return eI(this.db[t],"You're trying to find model(s) of type ".concat(e," but this collection doesn't exist in the database.")),this.db[t]}},{key:"toCollectionName",value:function(e){if("string"!=typeof e1[e]){var t=eF(e),i=eb(this._container.inflector.pluralize(t));e1[e]=i}return e1[e]}},{key:"toInternalCollectionName",value:function(e){if("string"!=typeof e2[e]){var t="_".concat(this.toCollectionName(e));e2[e]=t}return e2[e]}},{key:"toModelName",value:function(e){if("string"!=typeof e4[e]){var t=eF(e),i=this._container.inflector.singularize(t);e4[e]=i}return e4[e]}},{key:"_addForeignKeyToRegistry",value:function(e,t){this._registry[e]=this._registry[e]||{class:null,foreignKeys:[]};var i=this._registry[e].foreignKeys;i.includes(t)||i.push(t)}},{key:"_instantiateModel",value:function(e,t){var i=this._modelFor(e),n=this._foreignKeysFor(e);return new i(this,e,t,n)}},{key:"_modelFor",value:function(e){return this._registry[eb(e)].class}},{key:"_foreignKeysFor",value:function(e){return this._registry[eb(e)].foreignKeys}},{key:"_hydrate",value:function(e,t){if(Array.isArray(e)){var i=e.map(function(e){return this._instantiateModel(t,e)},this);return new eS(t,i)}return e?this._instantiateModel(t,e):null}}]),e}(),e8={Db:ej,Association:eM,RouteHandler:eU,BaseRouteHandler:ex,Serializer:eV,SerializerRegistry:e0,Schema:e3},e9={singularize:f.ES,pluralize:f.td},e5=function(){function e(){U(this,e),this.inflector=e9}return Z(e,[{key:"register",value:function(e,t){this[e]=t}},{key:"create",value:function(e){var t=e8[e];t.prototype._container=this;for(var i=arguments.length,n=Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];return en(t,n)}}]),e}(),e6=new e5;ej.prototype._container=e6,eM.prototype._container=e6,ex.prototype._container=e6,eU.prototype._container=e6,eV.prototype._container=e6,e0.prototype._container=e6,e3.prototype._container=e6;var e7=["http://localhost:0/chromecheckurl","http://localhost:30820/socket.io",function(e){return/.+\.hot-update.json$/.test(e.url)}],te={coalesce:!1,timing:void 0},tt=function(){function e(){U(this,e),V(this,"urlPrefix",void 0),V(this,"namespace",void 0),V(this,"timing",void 0),V(this,"passthroughChecks",void 0),V(this,"pretender",void 0),V(this,"mirageServer",void 0),V(this,"trackRequests",void 0)}return Z(e,[{key:"create",value:function(e,t){var i=this;this.mirageServer=e,this.pretender=this._create(e,t),e.pretender=this.pretender,this.passthroughChecks=this.passthroughChecks||[],this.config(t),[["get"],["post"],["put"],["delete","del"],["patch"],["head"],["options"]].forEach(function(t){var n=es(t,2),r=n[0],o=n[1];i[r]=function(t){for(var n,o=arguments.length,s=Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];var c=function(e){var t=es(e.splice(-1),1)[0];(function(e){if(!e||"object"!==Q(e))return!1;for(var t=Object.keys(te),i=Object.keys(e),n=0;n<i.length;n++){var r=i[n];if(t.indexOf(r)>-1)return!0}return!1})(t)?t=Y()({},te,t):(e.push(t),t=te);for(var i=2-e.length;i-- >0;)e.push(void 0);return e.push(t),e}(s),u=es(c,3),l=u[0],h=u[1],d=u[2],f=e.registerRouteHandler(r,t,l,h,d),y=i._getFullPath(t),m=void 0!==d.timing?d.timing:function(){return i.timing};return null===(n=i.pretender)||void 0===n?void 0:n[r](y,f,m)},e[r]=i[r],o&&(i[o]=i[r],e[o]=i[r])})}},{key:"config",value:function(e){var t,i;(void 0===e.useDefaultPassthroughs||e.useDefaultPassthroughs)&&this._configureDefaultPassthroughs(),eI(!(void 0!==e.trackRequests&&e.trackRequests!==this.trackRequests),"You cannot modify Pretender's request tracking once the server is created"),this.timing=null!==(t=null!==(i=e.timing)&&void 0!==i?i:this.timing)&&void 0!==t?t:400,this.urlPrefix=this.urlPrefix||e.urlPrefix||"",this.namespace=this.namespace||e.namespace||""}},{key:"_configureDefaultPassthroughs",value:function(){var e=this;e7.forEach(function(t){e.passthrough(t)})}},{key:"_create",value:function(e,t){if("undefined"!=typeof window)return this.trackRequests=t.trackRequests||!1,new G.A(function(){this.passthroughRequest=function(t,i,n){e.shouldLog()&&console.log("Mirage: Passthrough request for ".concat(t.toUpperCase()," ").concat(n.url))},this.handledRequest=function(t,i,n){if(e.shouldLog()){console.groupCollapsed("Mirage: [".concat(n.status,"] ").concat(t.toUpperCase()," ").concat(n.url));var r,o,s=n.requestBody,a=n.responseText;try{r=JSON.parse(s)}catch(e){r=s}try{o=JSON.parse(a)}catch(e){o=a}console.groupCollapsed("Response"),console.log(o),console.groupEnd(),console.groupCollapsed("Request (data)"),console.log(r),console.groupEnd(),console.groupCollapsed("Request (raw)"),console.log(n),console.groupEnd(),console.groupEnd()}};var t=this.checkPassthrough;this.checkPassthrough=function(i){if(e.passthroughChecks.some(function(e){return e(i)})){var n=i.url.includes("?")?i.url.substr(0,i.url.indexOf("?")):i.url;this[i.method.toLowerCase()](n,this.passthrough)}return t.apply(this,arguments)},this.unhandledRequest=function(e,t){t=decodeURI(t);var i="";i=""===this.namespace?"There is no existing namespace defined. Please define one":"The existing namespace is ".concat(this.namespace),eI("Your app tried to ".concat(e," '").concat(t,"', but there was no route defined to handle this request. Define a route for this endpoint in your routes() config. Did you forget to define a namespace? ").concat(i))}},{trackRequests:this.trackRequests})}},{key:"passthrough",value:function(){for(var e=this,t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];if("undefined"!=typeof window){var r=["get","post","put","delete","patch","options","head"],o=i[i.length-1];0===i.length?i=["/**","/"]:i.length>1&&Array.isArray(o)&&(r=i.pop()),i.forEach(function(t){"function"==typeof t?e.passthroughChecks.push(t):r.forEach(function(i){var n=e._getFullPath(t);e.pretender[i](n,e.pretender.passthrough)})})}}},{key:"_getFullPath",value:function(e){e="/"===e[0]?e.slice(1):e;var t="",i=this.urlPrefix?this.urlPrefix.trim():"",n="";if(this.urlPrefix&&this.namespace&&("/"===this.namespace[0]&&"/"===this.namespace[this.namespace.length-1]&&(n=this.namespace.substring(0,this.namespace.length-1).substring(1)),"/"===this.namespace[0]&&"/"!==this.namespace[this.namespace.length-1]&&(n=this.namespace.substring(1)),"/"!==this.namespace[0]&&"/"===this.namespace[this.namespace.length-1]&&(n=this.namespace.substring(0,this.namespace.length-1)),"/"!==this.namespace[0]&&"/"!==this.namespace[this.namespace.length-1]&&(n=this.namespace)),this.namespace&&!this.urlPrefix){if("/"===this.namespace[0]&&"/"===this.namespace[this.namespace.length-1]&&(n=this.namespace.substring(0,this.namespace.length-1)),"/"===this.namespace[0]&&"/"!==this.namespace[this.namespace.length-1]&&(n=this.namespace),"/"!==this.namespace[0]&&"/"===this.namespace[this.namespace.length-1]){var r=this.namespace.substring(0,this.namespace.length-1);n="/".concat(r)}"/"!==this.namespace[0]&&"/"!==this.namespace[this.namespace.length-1]&&(n="/".concat(this.namespace))}return this.namespace||(n=""),/^https?:\/\//.test(e)?t+=e:(i.length&&(t+="/"===i[i.length-1]?i:"".concat(i,"/")),"/"!==(t+=n)[t.length-1]&&(t+="/"),t+=e,/^https?:\/\//.test(t)||(t=(t="/".concat(t)).replace(/\/+/g,"/"))),t}},{key:"start",value:function(){}},{key:"shutdown",value:function(){this.pretender.shutdown()}}]),e}(),ti={},tn={singularize:f.ES,pluralize:f.td};function tr(e){return new to(e)}var to=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};U(this,e),this._container=new e5,this.config(t),this.db=this.db||void 0,this.schema=this.schema||void 0,this.middleware=[]}return Z(e,[{key:"namespace",get:function(){return this.interceptor.namespace},set:function(e){this.interceptor.namespace=e}},{key:"urlPrefix",get:function(){return this.interceptor.urlPrefix},set:function(e){this.interceptor.urlPrefix=e}},{key:"timing",get:function(){return this.interceptor.timing},set:function(e){this.interceptor.timing=e}},{key:"passthroughChecks",get:function(){return this.interceptor.passthroughChecks},set:function(e){this.interceptor.passthroughChecks=e}},{key:"config",value:function(){var e,t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i.interceptor||(i.interceptor=new tt),this.interceptor?this.interceptor.config(i):(this.interceptor=i.interceptor,this.interceptor.create(this,i)),eI(!(i.environment&&this.environment&&this.environment!==i.environment),"You cannot modify Mirage's environment once the server is created"),this.environment=i.environment||this.environment||"development",i.routes&&(eI(!i.baseConfig,"The routes option is an alias for the baseConfig option. You can't pass both options into your server definition."),i.baseConfig=i.routes),i.seeds&&(eI(!i.scenarios,"The seeds option is an alias for the scenarios.default option. You can't pass both options into your server definition."),i.scenarios={default:i.seeds}),this._config=i,this.inflector=i.inflector||tn,this._container.register("inflector",this.inflector),this.logging=void 0!==i.logging?this.logging:void 0,this.testConfig=this.testConfig||void 0,this.trackRequests=i.trackRequests,this.db?this.db.registerIdentityManagers(i.identityManagers):this.db=this._container.create("Db",void 0,i.identityManagers),this.schema?(this.schema.registerModels(i.models),this.serializerOrRegistry.registerSerializers(i.serializers||{})):(this.schema=this._container.create("Schema",this.db,i.models),this.serializerOrRegistry=this._container.create("SerializerRegistry",this.schema,i.serializers));var n=this._hasModulesOfType(i,"factories"),r=i.scenarios&&Object.prototype.hasOwnProperty.call(i.scenarios,"default");i.baseConfig&&this.loadConfig(i.baseConfig),this.isTest()&&(this.loadConfig(i.testConfig),"undefined"!=typeof window&&(window.server=this)),this.isTest()&&n?this.loadFactories(i.factories):!this.isTest()&&r?(this.loadFactories(i.factories),i.scenarios.default(this)):this.loadFixtures(),null===(e=(t=this.interceptor).start)||void 0===e||e.call(t)}},{key:"isTest",value:function(){return"test"===this.environment}},{key:"shouldLog",value:function(){return void 0!==this.logging?this.logging:!this.isTest()}},{key:"loadConfig",value:function(e){null==e||e.call(this),this.timing=this.isTest()?0:this.timing||0}},{key:"passthrough",value:function(){for(var e,t,i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];null===(e=(t=this.interceptor).passthrough)||void 0===e||e.call.apply(e,[t].concat(n))}},{key:"loadFixtures",value:function(){for(var e=this._config.fixtures,t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];if(i.length){var r=i.map(eb),o=r.filter(function(t){return!e[t]});if(o.length)throw Error("Fixtures not found: ".concat(o.join(", ")));e=x().apply(void 0,[e].concat(ea(r)))}this.db.loadData(e)}},{key:"loadFactories",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=this._factoryMap||{};this._factoryMap=Y()(i,t),Object.keys(t).forEach(function(t){var i=e.schema.toCollectionName(t);e.db.createCollection(i)})}},{key:"factoryFor",value:function(e){var t=eb(e);if(this._factoryMap&&this._factoryMap[t])return this._factoryMap[t]}},{key:"build",value:function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];var o=i.filter(function(e){return e&&"string"==typeof e}),s=B()(i,function(e){return r()(e)}),a=eb(e);this.factorySequences=this.factorySequences||{},this.factorySequences[a]=this.factorySequences[a]+1||0;var c=this.factoryFor(e);if(!c)return s;var u=(c=c.extend({})).attrs||{};this._validateTraits(o,c,e);var l=this._mergeExtensions(u,o,s);this._mapAssociationsFromAttributes(e,u,s),this._mapAssociationsFromAttributes(e,l);var h=new(c.extend(l)),d=this.factorySequences[a];return h.build(d)}},{key:"buildList",value:function(e,t){eI(L()(t),"second argument has to be an integer, you passed: ".concat(Q(t)));for(var i=[],n=arguments.length,r=Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];for(var s=[e].concat(r),a=0;a<t;a++)i.push(this.build.apply(this,s));return i}},{key:"create",value:function(e){var t,i,n,o=this;eI(this._modelOrFactoryExistsForType(e),"You called server.create('".concat(e,"') but no model or factory was found. Make sure you're passing in the singularized version of the model or factory name."));for(var s=arguments.length,a=Array(s>1?s-1:0),c=1;c<s;c++)a[c-1]=arguments[c];var u=a.filter(function(e){return e&&"string"==typeof e}),l=B()(a,function(e){return r()(e)}),h=B()(a,function(e){return e&&Array.isArray(e)}),d=this.build.apply(this,[e].concat(ea(u),[l]));this.schema&&this.schema[this.schema.toCollectionName(e)]?t=this.schema[this.schema.toCollectionName(e)].create(d):(h?i=h:(n=this.schema?this.schema.toInternalCollectionName(e):"_".concat(this.inflector.pluralize(e)),i=this.db[n]),eI(i,"You called server.create('".concat(e,"') but no model or factory was found.")),t=i.insert(d));var f=this.factoryFor(e);return f&&f.extractAfterCreateCallbacks({traits:u}).forEach(function(e){e(t,o)}),t}},{key:"createList",value:function(e,t){eI(this._modelOrFactoryExistsForType(e),"You called server.createList('".concat(e,"') but no model or factory was found. Make sure you're passing in the singularized version of the model or factory name.")),eI(L()(t),"second argument has to be an integer, you passed: ".concat(Q(t)));for(var i=[],n=this.schema?this.schema.toInternalCollectionName(e):"_".concat(this.inflector.pluralize(e)),r=this.db[n],o=arguments.length,s=Array(o>2?o-2:0),a=2;a<o;a++)s[a-2]=arguments[a];for(var c=[e].concat(s,[r]),u=0;u<t;u++)i.push(this.create.apply(this,c));return i}},{key:"shutdown",value:function(){"undefined"!=typeof window&&this.interceptor.shutdown(),"undefined"!=typeof window&&"test"===this.environment&&(window.server=void 0)}},{key:"resource",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i.only,r=i.except,o=i.path;if(e=this.inflector.pluralize(e),o=o||"/".concat(e),r=r||[],(n=n||[]).length>0&&r.length>0)throw"cannot use both :only and :except options";var s={index:{methods:["get"],path:"".concat(o)},show:{methods:["get"],path:"".concat(o,"/:id")},create:{methods:["post"],path:"".concat(o)},update:{methods:["put","patch"],path:"".concat(o,"/:id")},delete:{methods:["del"],path:"".concat(o,"/:id")}},a=Object.keys(s);(n.length>0&&n||r.length>0&&a.filter(function(e){return -1===r.indexOf(e)})||a).forEach(function(i){var n=s[i];n.methods.forEach(function(i){return o===e?t[i](n.path):t[i](n.path,e)})})}},{key:"_serialize",value:function(e){return"string"==typeof e?e:JSON.stringify(e)}},{key:"registerRouteHandler",value:function(e,t,i,n,r){var o=this,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.middleware,a=this._container.create("RouteHandler",{schema:this.schema,verb:e,rawHandler:i,customizedCode:n,options:r,path:t,serializerOrRegistry:this.serializerOrRegistry,middleware:s});return function(e){return a.handle(e).then(function(e){var t=es(e,3),i=t[0],n=t[1],r=t[2];return[i,n,o._serialize(r)]})}}},{key:"_hasModulesOfType",value:function(e,t){var i=e[t];return!!i&&Object.keys(i).length>0}},{key:"_typeIsPluralForModel",value:function(e){if("boolean"!=typeof ti[e]){var t=this._modelOrFactoryExistsForTypeOrCollectionName(e),i=e===this.inflector.pluralize(e),n=this.inflector.singularize(e)===this.inflector.pluralize(e);ti[e]=i&&!n&&t}return ti[e]}},{key:"_modelOrFactoryExistsForType",value:function(e){var t=this.schema&&this.schema.modelFor(eb(e)),i=this.db[this.schema.toInternalCollectionName(e)];return(t||i)&&!this._typeIsPluralForModel(e)}},{key:"_modelOrFactoryExistsForTypeOrCollectionName",value:function(e){var t=this.schema&&this.schema.modelFor(eb(e)),i=this.db[this.schema.toInternalCollectionName(e)];return t||i}},{key:"_validateTraits",value:function(e,t,i){e.forEach(function(e){if(!t.isTrait(e))throw Error("'".concat(e,"' trait is not registered in '").concat(i,"' factory"))})}},{key:"_mergeExtensions",value:function(e,t,i){var n=t.map(function(t){return e[t].extension});return n.push(i||{}),n.reduce(function(e,t){return Y()(e,t)},{})}},{key:"_mapAssociationsFromAttributes",value:function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.keys(t||{}).filter(function(e){var i;return i=t[e],r()(i)&&!0===i.__isAssociation__}).forEach(function(r){var o=i.schema.modelClassFor(e).associationFor(r);eI(o&&o instanceof eO,"You're using the `association` factory helper on the '".concat(r,"' attribute of your ").concat(e," factory, but that attribute is not a `belongsTo` association.")),eI(!(o&&o instanceof eO&&o.modelName===e),"You're using the association() helper on your ".concat(e," factory for ").concat(r,", which is a belongsTo self-referential relationship. You can't do this as it will lead to infinite recursion. You can move the helper inside of a trait and use it selectively.")),eI(!(o&&o.opts&&o.opts.polymorphic),"You're using the association() helper on your ".concat(e," factory for ").concat(r,", which is a polymorphic relationship. This is not currently supported."));var s=t[r],a="".concat(eb(r),"Id");n[r]||(t[a]=i.create.apply(i,[o.modelName].concat(ea(s.traitsAndOverrides))).id),delete t[r]})}}]),e}(),ts=eV.extend({serializeIds:"always",normalizeIds:!0,keyForModel:function(e){return eA(e)},keyForAttribute:function(e){return e=eV.prototype.keyForAttribute.apply(this,arguments),eA(e)},keyForRelationship:function(e){return this._container.inflector.pluralize(eA(e))},keyForEmbeddedRelationship:function(e){return eA(e)},keyForRelationshipIds:function(e){return"".concat(eA(this._container.inflector.singularize(e)),"_ids")},keyForForeignKey:function(e){return"".concat(eA(e),"_id")},keyForPolymorphicForeignKeyId:function(e){return"".concat(eA(e),"_id")},keyForPolymorphicForeignKeyType:function(e){return"".concat(eA(e),"_type")},normalize:function(e){var t=this,i=Object.keys(e)[0],n=e[i],r=eb(i),o=this.schema.modelClassFor(r),s=o.belongsToAssociations,a=o.hasManyAssociations,c=Object.keys(s),u=Object.keys(a);"id"!==this.primaryKey&&(n.id=n[this.primaryKey],delete n[this.primaryKey]);var l={data:{type:this._container.inflector.pluralize(i),attributes:{}}};n.id&&(l.data.id=n.id);var h={};return Object.keys(n).forEach(function(e){if("id"!==e){if(t.normalizeIds){if(c.includes(e)){var i=s[e].modelName;h[eF(e)]={data:{type:i,id:n[e]}}}else if(u.includes(e)){var r=a[e].modelName,o=n[e].map(function(e){return{type:r,id:e}});h[eF(e)]={data:o}}else l.data.attributes[eF(e)]=n[e]}else l.data.attributes[eF(e)]=n[e]}}),Object.keys(h).length&&(l.data.relationships=h),l},getCoalescedIds:function(e){return e.queryParams&&e.queryParams.ids}}),ta=ts.extend({serializeIds:"always",keyForModel:function(e){return eb(e)},keyForAttribute:function(e){return e=ts.prototype.keyForAttribute.apply(this,arguments),eb(e)},keyForRelationship:function(e){return eb(this._container.inflector.pluralize(e))},keyForEmbeddedRelationship:function(e){return eb(e)},keyForRelationshipIds:function(e){return eb(this._container.inflector.pluralize(e))},keyForForeignKey:function(e){return eb(this._container.inflector.singularize(e))},getCoalescedIds:function(e){return e.queryParams&&e.queryParams.ids}})}}]);